<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wake Lock Demo - –¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Å–Ω–∞</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #0f1e28, #1a2b3a);
            color: white;
            min-height: 100vh;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
        }
        h1 {
            text-align: center;
            color: #4CAF50;
            margin-bottom: 30px;
        }
        .status-panel {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #4CAF50;
        }
        .control-panel {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        button {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 140px;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.4);
        }
        button:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }
        .log-panel {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        .log-entry {
            margin: 5px 0;
            padding: 5px;
            border-radius: 4px;
        }
        .log-success { background: rgba(76, 175, 80, 0.2); }
        .log-warning { background: rgba(255, 152, 0, 0.2); }
        .log-error { background: rgba(244, 67, 54, 0.2); }
        .log-info { background: rgba(33, 150, 243, 0.2); }
        .feature-list {
            list-style: none;
            padding: 0;
        }
        .feature-list li {
            margin: 10px 0;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border-left: 3px solid #4CAF50;
        }
        .timer {
            font-size: 24px;
            text-align: center;
            color: #4CAF50;
            font-weight: bold;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõ°Ô∏è Wake Lock Demo</h1>
        <p style="text-align: center; font-size: 18px; margin-bottom: 30px;">
            –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Å–ø—è—â–µ–≥–æ —Ä–µ–∂–∏–º–∞
        </p>

        <div class="status-panel">
            <h3>üìä –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã</h3>
            <div id="status-info">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>

        <div class="control-panel">
            <button id="activate-btn">üîí –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
            <button id="deactivate-btn">üîì –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
            <button id="status-btn">üìä –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å</button>
            <button id="clear-log-btn">üßπ –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
        </div>

        <div class="timer" id="active-timer" style="display: none;">
            –ê–∫—Ç–∏–≤–Ω–æ: <span id="timer-value">00:00:00</span>
        </div>

        <div class="log-panel">
            <h3>üìù –õ–æ–≥ —Å–æ–±—ã—Ç–∏–π</h3>
            <div id="log-container"></div>
        </div>

        <div class="status-panel">
            <h3>‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã</h3>
            <ul class="feature-list">
                <li>üåü <strong>Screen Wake Lock API</strong> - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä–Ω—ã–π API</li>
                <li>üîÑ <strong>Fallback –º–µ—Ç–æ–¥—ã</strong> - –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤</li>
                <li>üîÅ <strong>–ê–≤—Ç–æ–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ</strong> - –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –≤–∫–ª–∞–¥–æ–∫</li>
                <li>üßπ <strong>–£–º–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞</strong> - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤</li>
                <li>üì± <strong>–ö—Ä–æ—Å—Å–±—Ä–∞—É–∑–µ—Ä–Ω–æ—Å—Ç—å</strong> - —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ</li>
            </ul>
        </div>
    </div>

    <script type="module">
        import wakeLockManager from './wakeLock.js';
        
        // UI —ç–ª–µ–º–µ–Ω—Ç—ã
        const statusInfo = document.getElementById('status-info');
        const activateBtn = document.getElementById('activate-btn');
        const deactivateBtn = document.getElementById('deactivate-btn');
        const statusBtn = document.getElementById('status-btn');
        const clearLogBtn = document.getElementById('clear-log-btn');
        const logContainer = document.getElementById('log-container');
        const activeTimer = document.getElementById('active-timer');
        const timerValue = document.getElementById('timer-value');

        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ç–∞–π–º–µ—Ä–∞
        let startTime = null;
        let timerInterval = null;

        // –§—É–Ω–∫—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry log-${type}`;
            logEntry.innerHTML = `<strong>[${timestamp}]</strong> ${message}`;
            logContainer.appendChild(logEntry);
            logContainer.scrollTop = logContainer.scrollHeight;
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π
            if (logContainer.children.length > 50) {
                logContainer.removeChild(logContainer.firstChild);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
        function updateStatus() {
            const status = wakeLockManager.getStatus();
            statusInfo.innerHTML = `
                <strong>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ Wake Lock API:</strong> ${status.isSupported ? '‚úÖ –î–∞' : '‚ùå –ù–µ—Ç'}<br>
                <strong>–°—Ç–∞—Ç—É—Å:</strong> ${status.isActive ? 'üü¢ –ê–∫—Ç–∏–≤–Ω–æ' : 'üî¥ –ù–µ–∞–∫—Ç–∏–≤–Ω–æ'}<br>
                <strong>–ù–∞—Ç–∏–≤–Ω—ã–π Wake Lock:</strong> ${status.hasNativeWakeLock ? '‚úÖ –î–∞' : '‚ùå –ù–µ—Ç'}<br>
                <strong>–ú–µ—Ç–æ–¥:</strong> ${status.method || '–ù–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω'}
            `;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
            activateBtn.disabled = status.isActive;
            deactivateBtn.disabled = !status.isActive;
            
            // –£–ø—Ä–∞–≤–ª—è–µ–º —Ç–∞–π–º–µ—Ä–æ–º
            if (status.isActive && !timerInterval) {
                startTimer();
            } else if (!status.isActive && timerInterval) {
                stopTimer();
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ —Ç–∞–π–º–µ—Ä–∞
        function startTimer() {
            startTime = Date.now();
            activeTimer.style.display = 'block';
            timerInterval = setInterval(() => {
                const elapsed = Date.now() - startTime;
                const hours = Math.floor(elapsed / 3600000);
                const minutes = Math.floor((elapsed % 3600000) / 60000);
                const seconds = Math.floor((elapsed % 60000) / 1000);
                
                timerValue.textContent = 
                    `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            activeTimer.style.display = 'none';
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        activateBtn.addEventListener('click', async () => {
            try {
                log('–ü–æ–ø—ã—Ç–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ Wake Lock...', 'info');
                const result = await wakeLockManager.requestWakeLock();
                if (result) {
                    log('‚úÖ Wake Lock —É—Å–ø–µ—à–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!', 'success');
                } else {
                    log('‚ö†Ô∏è Wake Lock –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω —Å fallback –º–µ—Ç–æ–¥–∞–º–∏', 'warning');
                }
                updateStatus();
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏: ${error.message}`, 'error');
            }
        });

        deactivateBtn.addEventListener('click', async () => {
            try {
                log('–î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è Wake Lock...', 'info');
                await wakeLockManager.releaseWakeLock();
                log('üîì Wake Lock —É—Å–ø–µ—à–Ω–æ –¥–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω', 'success');
                updateStatus();
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏: ${error.message}`, 'error');
            }
        });

        statusBtn.addEventListener('click', () => {
            const status = wakeLockManager.getStatus();
            log(`üìä –°—Ç–∞—Ç—É—Å: ${JSON.stringify(status, null, 2)}`, 'info');
            updateStatus();
        });

        clearLogBtn.addEventListener('click', () => {
            logContainer.innerHTML = '';
            log('üßπ –õ–æ–≥ –æ—á–∏—â–µ–Ω', 'info');
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            log('üöÄ Wake Lock Demo –∑–∞–≥—Ä—É–∂–µ–Ω', 'success');
            updateStatus();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
            setInterval(updateStatus, 5000);
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–∫—Ä—ã—Ç–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('beforeunload', () => {
            if (wakeLockManager.getStatus().isActive) {
                wakeLockManager.releaseWakeLock();
            }
        });
    </script>
</body>
</html> 